<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Suraj Typing Test</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f4f4f4;
      margin: 0;
      padding: 20px;
    }
    .container {
      max-width: 900px;
      margin: auto;
      background: #fff;
      padding: 20px;
      border-radius: 15px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    h1 {
      text-align: center;
      margin-bottom: 10px;
    }
    #modeToggle, #backspaceToggle {
      margin: 10px 0;
    }
    #paragraphBox {
      border: 2px solid #ccc;
      border-radius: 10px;
      padding: 15px;
      margin: 20px 0;
      min-height: 150px;
      background-color: #f9f9f9;
      overflow-y: auto;
    }
    .word {
      padding: 3px;
      margin: 2px;
      display: inline-block;
      border-radius: 5px;
    }
    .current {
      background: yellow;
    }
    .correct {
      color: green;
    }
    .incorrect {
      color: red;
    }
    #result {
      margin-top: 20px;
      font-size: 18px;
      display: none;
    }
    #controls {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
    }
    textarea {
      width: 100%;
      height: 100px;
    }
    @media (max-width: 600px) {
      #controls {
        flex-direction: column;
        align-items: flex-start;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Suraj Typing Test</h1>
    
    <div id="controls">
      <label>
        Name:
        <input type="text" id="username" placeholder="Enter your name" />
      </label>

      <label>
        Mode:
        <select id="modeToggle">
          <option value="practice">Practice Mode</option>
          <option value="exam">Exam Mode</option>
        </select>
      </label>

      <label>
        Duration:
        <select id="duration">
          <option value="1">1 Min</option>
          <option value="2">2 Min</option>
          <option value="5">5 Min</option>
          <option value="10">10 Min</option>
          <option value="15">15 Min</option>
          <option value="20">20 Min</option>
        </select>
      </label>

      <label>
        <input type="checkbox" id="backspaceToggle" checked /> Allow Backspace
      </label>

      <button onclick="startTest()">Start Test</button>
    </div>

    <div id="examInputBox" style="display: none; margin-top: 10px;">
      <label>
        Paste your paragraph for exam mode:
        <textarea id="examText"></textarea>
      </label>
    </div>

    <div id="paragraphBox"></div>

    <input type="text" id="inputField" placeholder="Start typing..." oninput="handleTyping()" disabled style="width: 100%; padding: 10px; font-size: 16px;" />

    <div id="timer">Time: 0:00</div>
    <div id="result"></div>
  </div>

  <script>
    const practiceTexts = [
      "Practice makes a man perfect. Keep typing every day to improve your speed and accuracy.",
      "Typing tests help you become faster and more confident with your keyboard.",
      "Consistency is the key to mastering typing skills."
    ];

    let words = [], current = 0, timer = null, timeLeft = 0, totalTyped = 0, correctTyped = 0;
    const paragraphBox = document.getElementById("paragraphBox");
    const inputField = document.getElementById("inputField");
    const timerDisplay = document.getElementById("timer");
    const resultBox = document.getElementById("result");

    function startTest() {
      const username = document.getElementById("username").value.trim();
      if (!username) return alert("Please enter your name!");

      const mode = document.getElementById("modeToggle").value;
      const duration = parseInt(document.getElementById("duration").value);
      const allowBackspace = document.getElementById("backspaceToggle").checked;

      document.getElementById("examInputBox").style.display = mode === "exam" ? "block" : "none";

      let text = "";
      if (mode === "exam") {
        text = document.getElementById("examText").value.trim();
        if (!text) return alert("Please paste exam paragraph!");
      } else {
        text = practiceTexts[Math.floor(Math.random() * practiceTexts.length)];
      }

      words = text.split(" ");
      current = 0;
      totalTyped = 0;
      correctTyped = 0;
      timeLeft = duration * 60;
      inputField.value = "";
      inputField.disabled = false;
      inputField.focus();
      resultBox.style.display = "none";

      renderParagraph();
      updateTimerDisplay();

      clearInterval(timer);
      timer = setInterval(() => {
        timeLeft--;
        updateTimerDisplay();
        if (timeLeft <= 0) finishTest();
      }, 1000);

      document.addEventListener("keydown", function (e) {
        if (!allowBackspace && e.key === "Backspace") {
          e.preventDefault();
        }
      });
    }

    function renderParagraph() {
      paragraphBox.innerHTML = "";
      words.forEach((word, index) => {
        const span = document.createElement("span");
        span.textContent = word;
        span.className = "word" + (index === 0 ? " current" : "");
        paragraphBox.appendChild(span);
      });
    }

    function handleTyping() {
      const typed = inputField.value.trim();
      const currentWord = words[current];
      const wordSpans = paragraphBox.querySelectorAll(".word");

      if (typed.endsWith(" ")) {
        totalTyped++;
        if (typed.trim().toLowerCase() === currentWord.toLowerCase()) {
          wordSpans[current].classList.add("correct");
          correctTyped++;
        } else {
          wordSpans[current].classList.add("incorrect");
        }
        wordSpans[current].classList.remove("current");
        current++;
        if (current < words.length) {
          wordSpans[current].classList.add("current");
        }
        inputField.value = "";

        // Scroll to current word
        const currentElement = wordSpans[current];
        if (currentElement) {
          currentElement.scrollIntoView({ behavior: "smooth", block: "center" });
        }
      }
    }

    function updateTimerDisplay() {
      const min = Math.floor(timeLeft / 60);
      const sec = timeLeft % 60;
      timerDisplay.textContent = `Time: ${min}:${sec.toString().padStart(2, '0')}`;
    }

    function finishTest() {
      clearInterval(timer);
      inputField.disabled = true;
      const accuracy = totalTyped === 0 ? 0 : Math.round((correctTyped / totalTyped) * 100);
      const wpm = Math.round((correctTyped / timeLeft) * 60);
      resultBox.innerHTML = `
        <strong>Result for ${document.getElementById("username").value}:</strong><br/>
        Accuracy: ${accuracy}%<br/>
        WPM: ${wpm}<br/>
        Correct Words: ${correctTyped}<br/>
        Total Typed: ${totalTyped}
      `;
      resultBox.style.display = "block";
    }

    // Toggle exam text box based on mode
    document.getElementById("modeToggle").addEventListener("change", function () {
      document.getElementById("examInputBox").style.display = this.value === "exam" ? "block" : "none";
    });
  </script>
</body>
</html>
